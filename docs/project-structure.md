# Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡ Remnawave Bedolaga Bot

## Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ù„ÛŒ

| ÙˆÛŒÚ˜Ú¯ÛŒ | Ù…Ù‚Ø¯Ø§Ø± |
|-------|-------|
| **Ù†Ø§Ù… Ù¾Ø±ÙˆÚ˜Ù‡** | Remnawave Bedolaga Bot (remnabot) |
| **Ù†ÙˆØ¹ Ù…Ø®Ø²Ù†** | Monolith (ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡) |
| **Ù†ÙˆØ¹ Ù¾Ø±ÙˆÚ˜Ù‡** | Backend (Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… + REST API) |
| **Ø²Ø¨Ø§Ù† Ø§ØµÙ„ÛŒ** | Python 3.13+ |
| **ÙØ±ÛŒÙ…â€ŒÙˆØ±Ú©â€ŒÙ‡Ø§** | aiogram 3, FastAPI, SQLAlchemy |
| **Ø¯ÛŒØªØ§Ø¨ÛŒØ³** | PostgreSQL 15+ / SQLite (ØªÙˆØ³Ø¹Ù‡) |
| **Ú©Ø´** | Redis |
| **Ø§Ø³ØªÙ‚Ø±Ø§Ø±** | Docker + Docker Compose |

## Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø¹Ù…Ø§Ø±ÛŒ

**Service-Oriented Architecture** Ø¨Ø§ Ø³Ø§Ø®ØªØ§Ø± Ù…Ø§Ú˜ÙˆÙ„Ø§Ø± handlers/services/database

### Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ

1. **Presentation Layer** - `app/handlers/`, `app/keyboards/`
2. **Business Logic Layer** - `app/services/`
3. **Data Access Layer** - `app/database/crud/`
4. **External Integration Layer** - `app/external/`
5. **API Layer** - `app/webapi/`

## Ø¯Ø±Ø®Øª Ù…Ù†Ø¨Ø¹

```
project-root/
â”œâ”€â”€ app/                           # Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø§ØµÙ„ÛŒ
â”‚   â”œâ”€â”€ bot.py                     # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø±Ø¨Ø§Øª
â”‚   â”œâ”€â”€ config.py                  # Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ (Pydantic Settings)
â”‚   â”œâ”€â”€ states.py                  # FSM States
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                  # Ù„Ø§ÛŒÙ‡ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ database.py            # Ø§ØªØµØ§Ù„ Ùˆ Ø³Ø´Ù† Ø¯ÛŒØªØ§Ø¨ÛŒØ³
â”‚   â”‚   â”œâ”€â”€ models.py              # Ù…Ø¯Ù„â€ŒÙ‡Ø§ÛŒ SQLAlchemy
â”‚   â”‚   â”œâ”€â”€ universal_migration.py # Ù…Ù‡Ø§Ø¬Ø±Øª Ø®ÙˆØ¯Ú©Ø§Ø±
â”‚   â”‚   â””â”€â”€ crud/                  # Ø¹Ù…Ù„ÛŒØ§Øª CRUD (36 ÙØ§ÛŒÙ„)
â”‚   â”‚
â”‚   â”œâ”€â”€ external/                  # ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒâ€ŒÙ‡Ø§ÛŒ Ø®Ø§Ø±Ø¬ÛŒ
â”‚   â”‚   â”œâ”€â”€ cryptobot.py           # Ù¾Ø±Ø¯Ø§Ø®Øª CryptoBot
â”‚   â”‚   â”œâ”€â”€ heleket.py             # Ù¾Ø±Ø¯Ø§Ø®Øª Heleket
â”‚   â”‚   â”œâ”€â”€ remnawave_api.py       # API Ù¾Ù†Ù„ Remnawave
â”‚   â”‚   â”œâ”€â”€ telegram_stars.py      # Ù¾Ø±Ø¯Ø§Ø®Øª Telegram Stars
â”‚   â”‚   â”œâ”€â”€ tribute.py             # Ù¾Ø±Ø¯Ø§Ø®Øª Tribute
â”‚   â”‚   â”œâ”€â”€ yookassa_webhook.py    # Ù¾Ø±Ø¯Ø§Ø®Øª YooKassa
â”‚   â”‚   â””â”€â”€ webhook_server.py      # Ø³Ø±ÙˆØ± webhookâ€ŒÙ‡Ø§
â”‚   â”‚
â”‚   â”œâ”€â”€ handlers/                  # Ù‡Ù†Ø¯Ù„Ø±Ù‡Ø§ÛŒ Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ admin/                 # Ù‡Ù†Ø¯Ù„Ø±Ù‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª (36 ÙØ§ÛŒÙ„)
â”‚   â”‚   â”œâ”€â”€ balance/               # Ù…Ø¯ÛŒØ±ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ (11 ÙØ§ÛŒÙ„)
â”‚   â”‚   â”œâ”€â”€ subscription/          # Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø´ØªØ±Ø§Ú© (13 ÙØ§ÛŒÙ„)
â”‚   â”‚   â”œâ”€â”€ common.py              # Ù‡Ù†Ø¯Ù„Ø±Ù‡Ø§ÛŒ Ø¹Ù…ÙˆÙ…ÛŒ
â”‚   â”‚   â”œâ”€â”€ menu.py                # Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ
â”‚   â”‚   â”œâ”€â”€ start.py               # Ø¯Ø³ØªÙˆØ± /start
â”‚   â”‚   â”œâ”€â”€ referral.py            # Ø³ÛŒØ³ØªÙ… Ø§Ø±Ø¬Ø§Ø¹
â”‚   â”‚   â”œâ”€â”€ support.py             # Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ
â”‚   â”‚   â””â”€â”€ tickets.py             # Ø³ÛŒØ³ØªÙ… ØªÛŒÚ©Øª
â”‚   â”‚
â”‚   â”œâ”€â”€ keyboards/                 # Ú©ÛŒØ¨ÙˆØ±Ø¯Ù‡Ø§ÛŒ ØªÙ„Ú¯Ø±Ø§Ù…
â”‚   â”‚   â”œâ”€â”€ admin.py               # Ú©ÛŒØ¨ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª
â”‚   â”‚   â”œâ”€â”€ inline.py              # Ú©ÛŒØ¨ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ø§ÛŒÙ†Ù„Ø§ÛŒÙ†
â”‚   â”‚   â””â”€â”€ reply.py               # Ú©ÛŒØ¨ÙˆØ±Ø¯Ù‡Ø§ÛŒ Ù¾Ø§Ø³Ø®
â”‚   â”‚
â”‚   â”œâ”€â”€ localization/              # Ú†Ù†Ø¯Ø²Ø¨Ø§Ù†Ú¯ÛŒ
â”‚   â”‚   â”œâ”€â”€ loader.py              # Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ±Ø¬Ù…Ù‡â€ŒÙ‡Ø§
â”‚   â”‚   â”œâ”€â”€ texts.py               # Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ Ø«Ø§Ø¨Øª
â”‚   â”‚   â”œâ”€â”€ default_locales/       # Ù‚Ø§Ù„Ø¨â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ (2 ÙØ§ÛŒÙ„)
â”‚   â”‚   â””â”€â”€ locales/               # ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØ±Ø¬Ù…Ù‡ (4 ÙØ§ÛŒÙ„)
â”‚   â”‚
â”‚   â”œâ”€â”€ middlewares/               # Ù…ÛŒØ§Ù†â€ŒØ§ÙØ²Ø§Ø±Ù‡Ø§ÛŒ Ø±Ø¨Ø§Øª
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py                # Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª
â”‚   â”‚   â”œâ”€â”€ throttling.py          # Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ù†Ø±Ø®
â”‚   â”‚   â”œâ”€â”€ logging.py             # Ù„Ø§Ú¯â€ŒÚ¯ÛŒØ±ÛŒ
â”‚   â”‚   â”œâ”€â”€ maintenance.py         # Ø­Ø§Ù„Øª ØªØ¹Ù…ÛŒØ±Ø§Øª
â”‚   â”‚   â””â”€â”€ channel_checker.py     # Ø¨Ø±Ø±Ø³ÛŒ Ø¹Ø¶ÙˆÛŒØª Ú©Ø§Ù†Ø§Ù„
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                  # Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ÛŒ Ù…Ù†Ø·Ù‚ Ú©Ø³Ø¨â€ŒÙˆÚ©Ø§Ø± (68 ÙØ§ÛŒÙ„)
â”‚   â”‚   â”œâ”€â”€ payment_service.py     # Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø±Ø¯Ø§Ø®Øª
â”‚   â”‚   â”œâ”€â”€ subscription_service.py # Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø´ØªØ±Ø§Ú©
â”‚   â”‚   â”œâ”€â”€ user_service.py        # Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
â”‚   â”‚   â”œâ”€â”€ backup_service.py      # Ù¾Ø´ØªÛŒØ¨Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
â”‚   â”‚   â”œâ”€â”€ monitoring_service.py  # Ù…Ø§Ù†ÛŒØªÙˆØ±ÛŒÙ†Ú¯
â”‚   â”‚   â””â”€â”€ ...                    # Ø³Ø§ÛŒØ± Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                     # ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ (21 ÙØ§ÛŒÙ„)
â”‚   â”‚   â”œâ”€â”€ cache.py               # Ú©Ø´
â”‚   â”‚   â”œâ”€â”€ formatters.py          # ÙØ±Ù…Øªâ€ŒØ¯Ù‡ÛŒ
â”‚   â”‚   â”œâ”€â”€ validators.py          # Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ webapi/                    # REST API Ø¨Ø§ FastAPI
â”‚   â”‚   â”œâ”€â”€ app.py                 # Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† FastAPI
â”‚   â”‚   â”œâ”€â”€ server.py              # Ø³Ø±ÙˆØ± uvicorn
â”‚   â”‚   â”œâ”€â”€ dependencies.py        # Dependency Injection
â”‚   â”‚   â”œâ”€â”€ middleware.py          # Ù…ÛŒØ§Ù†â€ŒØ§ÙØ²Ø§Ø± API
â”‚   â”‚   â”œâ”€â”€ routes/                # Ø±ÙˆØªâ€ŒÙ‡Ø§ÛŒ API (32 ÙØ§ÛŒÙ„)
â”‚   â”‚   â””â”€â”€ schemas/               # Ø§Ø³Ú©ÛŒÙ…Ø§Ù‡Ø§ÛŒ Pydantic (29 ÙØ§ÛŒÙ„)
â”‚   â”‚
â”‚   â””â”€â”€ webserver/                 # Ø³Ø±ÙˆØ± ÙˆØ¨ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡
â”‚       â”œâ”€â”€ unified_app.py         # Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡
â”‚       â”œâ”€â”€ payments.py            # webhookâ€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª
â”‚       â””â”€â”€ telegram.py            # webhook ØªÙ„Ú¯Ø±Ø§Ù…
â”‚
â”œâ”€â”€ migrations/                    # Ù…Ù‡Ø§Ø¬Ø±Øªâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
â”‚   â””â”€â”€ alembic/
â”‚       â”œâ”€â”€ env.py
â”‚       â””â”€â”€ versions/              # Ù†Ø³Ø®Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ø§Ø¬Ø±Øª (12 ÙØ§ÛŒÙ„)
â”‚
â”œâ”€â”€ tests/                         # ØªØ³Øªâ€ŒÙ‡Ø§
â”‚   â”œâ”€â”€ conftest.py                # fixtures Ø¹Ù…ÙˆÙ…ÛŒ
â”‚   â”œâ”€â”€ crud/                      # ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ CRUD
â”‚   â”œâ”€â”€ services/                  # ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ (23 ÙØ§ÛŒÙ„)
â”‚   â”œâ”€â”€ external/                  # ØªØ³Øªâ€ŒÙ‡Ø§ÛŒ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡â€ŒØ³Ø§Ø²ÛŒ (4 ÙØ§ÛŒÙ„)
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ miniapp/                       # Mini App ØªÙ„Ú¯Ø±Ø§Ù…
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ payment/                   # ØµÙØ­Ø§Øª Ù¾Ø±Ø¯Ø§Ø®Øª
â”‚
â”œâ”€â”€ docs/                          # Ù…Ø³ØªÙ†Ø¯Ø§Øª
â”‚   â”œâ”€â”€ contests-api.md
â”‚   â”œâ”€â”€ miniapp-setup.md
â”‚   â”œâ”€â”€ web-admin-integration.md
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ locales/                       # ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø²Ø¨Ø§Ù† Ø³ÙØ§Ø±Ø´ÛŒ
â”œâ”€â”€ logs/                          # ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ú¯
â”œâ”€â”€ data/                          # Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ runtime
â”‚
â”œâ”€â”€ main.py                        # ğŸš€ Ù†Ù‚Ø·Ù‡ ÙˆØ±ÙˆØ¯ Ø§ØµÙ„ÛŒ
â”œâ”€â”€ requirements.txt               # ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Python
â”œâ”€â”€ Dockerfile                     # Ø§ÛŒÙ…ÛŒØ¬ Docker
â”œâ”€â”€ docker-compose.yml             # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Docker Compose
â”œâ”€â”€ docker-compose.local.yml       # ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù…Ø­Ù„ÛŒ
â”œâ”€â”€ Makefile                       # Ø¯Ø³ØªÙˆØ±Ø§Øª make
â”œâ”€â”€ alembic.ini                    # Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Alembic
â”œâ”€â”€ app-config.json                # Ù¾ÛŒÚ©Ø±Ø¨Ù†Ø¯ÛŒ Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù†
â”‚
â”œâ”€â”€ README.md                      # Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡
â”œâ”€â”€ CONTRIBUTING.md                # Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ù…Ø´Ø§Ø±Ú©Øª
â”œâ”€â”€ LICENSE                        # Ù…Ø¬ÙˆØ² MIT
â””â”€â”€ SECURITY.md                    # Ø³ÛŒØ§Ø³Øª Ø§Ù…Ù†ÛŒØªÛŒ
```

## Ù†Ù‚Ø§Ø· ÙˆØ±ÙˆØ¯

| Ù†Ù‚Ø·Ù‡ ÙˆØ±ÙˆØ¯ | Ù…Ø³ÛŒØ± | ØªÙˆØ¶ÛŒØ­Ø§Øª |
|-----------|------|---------|
| **Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† Ø§ØµÙ„ÛŒ** | `main.py` | Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø±Ø¨Ø§Øª Ùˆ Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§ |
| **Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù…** | `app/bot.py` â†’ `setup_bot()` | ØªÙ†Ø¸ÛŒÙ… aiogram |
| **REST API** | `app/webapi/app.py` | Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† FastAPI |
| **Ø³Ø±ÙˆØ± ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡** | `app/webserver/unified_app.py` | Ø³Ø±ÙˆØ± webhook + API |

## ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ

| ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ | Ù†Ø³Ø®Ù‡ | Ú©Ø§Ø±Ø¨Ø±Ø¯ |
|---------|------|--------|
| aiogram | 3.22.0 | ÙØ±ÛŒÙ…â€ŒÙˆØ±Ú© Ø±Ø¨Ø§Øª ØªÙ„Ú¯Ø±Ø§Ù… |
| fastapi | 0.115.6 | REST API |
| SQLAlchemy | 2.0.43 | ORM Ø¯ÛŒØªØ§Ø¨ÛŒØ³ |
| alembic | 1.16.5 | Ù…Ù‡Ø§Ø¬Ø±Øª Ø¯ÛŒØªØ§Ø¨ÛŒØ³ |
| pydantic | 2.11.9 | Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ø¯Ø§Ø¯Ù‡ |
| redis | 5.0.1 | Ú©Ø´ Ùˆ Ø³Ø´Ù† |
| asyncpg | 0.30.0 | Ø¯Ø±Ø§ÛŒÙˆØ± PostgreSQL |
| uvicorn | 0.32.1 | Ø³Ø±ÙˆØ± ASGI |
| APScheduler | 3.11.0 | Ø²Ù…Ø§Ù†â€ŒØ¨Ù†Ø¯ÛŒ ÙˆØ¸Ø§ÛŒÙ |

## ØªØ§Ø±ÛŒØ® ØªÙˆÙ„ÛŒØ¯

- **ØªØ§Ø±ÛŒØ®:** 2025-12-25
- **Ø­Ø§Ù„Øª Ø§Ø³Ú©Ù†:** exhaustive
- **Ù†Ø³Ø®Ù‡ Ú¯Ø±Ø¯Ø´â€ŒÚ©Ø§Ø±:** 1.2.0

